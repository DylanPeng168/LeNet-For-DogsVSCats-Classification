# LeNet-For-DogsVSCats-Classification
**1.** **个人项目完成内容**

 使用LeNet5网络进行猫狗分类识别

**2.** **实现项目具体介绍**

数据处理：

因为网络比较简单，所以我从原始DogsVSCatsDataset中的训练集中摘取了猫狗图片各10000张图片作为训练集，从原始DogsVSCatsDataset中的训练集中摘取了猫狗图片各2500张作为测试集，并调整图片大小为200×200

LeNet5模型改良：

初始LeNet5网络模型架构如下图

![image-20221219212907239](C:\Users\86150\AppData\Roaming\Typora\typora-user-images\image-20221219212907239.png)

模型各层参数设置如下图

![image-20221219213002403](C:\Users\86150\AppData\Roaming\Typora\typora-user-images\image-20221219213002403.png)

 因为LeNet5初始就是用来做手写数字体识别的，输入的图片是单通道图，而猫狗识别中数据集的图片都是三通道的，所以需要修改网络输入；为了将更多原始平面信息转换成尽可能多的空间通道信息，将Conv1的卷积核数增加到了16，Conv2中的卷积核数量增加到32，于是在FC1的输入改变为32×47×47，并设置为128个神经元，FC2输入为128，并设置为63个神经元，FC3输入为64，输出为2，即分别预测为猫和狗的概率值。

训练超参数设置：

```
dataset_dir = './data/'             # 数据集路径
model_cp = './model/'               # 网络参数保存位置
workers = 0                        # PyTorch读取数据线程数量
batch_size = 16                     # batch_size大小
lr = 0.0001                         # 学习率
epochs = 20                          # 训练总轮数
```

 训练损失函数：

```
criterion = torch.nn.CrossEntropyLoss()                         
# 定义loss计算方法，cross entropy，交叉熵，可以理解为两者数值越接近其值越小

loss = criterion(out, label.squeeze())      
# 计算损失，也就是网络输出值和实际label的差异，显然差异越小说明网络拟合效果越好，此处需要注意的是第二个参数，必须是一个1维Tensor

```

 

**3.** **实验结果及分析**

猫狗分类预测模型结果评价指标：

这里选用了准确率，错误率，混淆矩阵来进行模型评估，下图为20轮训练过程中每一轮的模型准确率变化曲线，可以看出在第6轮时模型准确率最高

![acc](C:\Users\86150\Desktop\junior_1\ML\期末大作业\acc.png)

二十轮的整体训练损失函数曲线结果如下，可以看到损失值在往变小的趋势发展，整体趋向收敛状态，训练效果较好。

![、loss](C:\Users\86150\Desktop\junior_1\ML\期末大作业\loss.png)

此次训练模型结果评估指标如下

准确率：78.26%

错误率 ：1-78.26%=21.74% 

混淆矩阵如下

| 模型混淆矩阵 | 真实值 |      |      |      |
| ------------ | ------ | ---- | ---- | ---- |
| 猫           | 狗     |      |      |      |
| 预测值       | 猫     | 1901 | 528  | 2429 |
| 狗           | 599    | 1972 | 2571 |      |
|              |        | 2500 | 2500 |      |

**4.** **个人思想感悟**

 为了让模型得到更高的准确度，我反复尝试了不同的超参数设置，也在模型使用的数据集上进行尝试，尝试把20000张图片缩减为一半或者更少，但是尝试后的效果也非常一般，于是最终还是采用了20000张图片作为训练集，5000张作为测试集的方法进行。最后得到的效果感觉还是可以的，77%的准确率，但是由于是二分类，这个准确率其实还是有待提高的，而且LeNet本身网络架构就很简单，只有五层卷积，所以在较大的数据集上做图像分类的效果应该不是太好。

<!--  -->
